[TOC]

# Keras Functional API

Keras的函数式接口是用于定义复杂的模型的，比如多输出模型，有向无环图，有共享层的模型等等。

## 第一个例子：一个全连接层连接的网络

这个例子使用Sequential更合适，但是这里为了演示functional API，所以没有使用它。

- layer实例是callable，传入一个tensor，输出一个tensor。
- 输入的tensor和输出的tensor可以用来定义一个model。

```python
from keras.layers import Input, Dense
from keras.models import Model

# 这个输出一个tensor
inputs = Input(shape=(784,))

output_1 = Dense(64, activation='relu')(inputs)
output_2 = Dense(64, activation='relu')(output1)
predications = Dense(10, activation='softmax')(output_2)

model = Model(inputs=inputs, outputs=predictions)
model.compile(optimizer='rmsprop',
    loss='categorical_crossentropy',
    metrics=['accuracy']
)

model.fit(data, labels)

```

## model也是callable，和layers一样

通过functional API，可以很容易地复用训练过的模型。可以把model视作一个layer，输入是tensor，输出是tensor。调用一个model时，不仅使用了这个模型的结构，同时也使用了这个模型的weights。

## 多输入和多输出模型

functional API的一个很好的用例：多输入、多输出模型。Keras的functional API可以很容易的创建大规模的相互交织的数据流。
